---
phase: 04-static-build-gsd-features
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/navigation.js
  - src/components/Sidebar.astro
autonomous: true

must_haves:
  truths:
    - "PROJECT.md, ROADMAP.md, REQUIREMENTS.md have icons in navigation"
    - "STATE.md is hidden from navigation sidebar"
    - "STATE.md is still accessible via direct URL (/STATE)"
  artifacts:
    - path: "src/lib/navigation.js"
      provides: "STATE.md filtering from nav tree"
      contains: "STATE"
    - path: "src/components/Sidebar.astro"
      provides: "Icons for root documentation files"
      contains: "svg"
  key_links:
    - from: "src/components/Sidebar.astro"
      to: "root doc icons"
      via: "inline SVG"
      pattern: "<svg.*viewBox"
---

<objective>
Add icons to root documentation files in sidebar and hide STATE.md from navigation.

Purpose: Root docs (PROJECT, ROADMAP, REQUIREMENTS) are entry points for understanding a project - icons make them visually prominent. STATE.md is internal/agent documentation that clutters navigation for human consumers.

Output: Sidebar shows icons next to root docs; STATE.md absent from navigation tree but still accessible via URL.
</objective>

<execution_context>
@/Users/jem/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/04-static-build-gsd-features/04-CONTEXT.md

Reference existing code:
@src/lib/navigation.js — Current buildNavTree implementation
@src/components/Sidebar.astro — Current sidebar rendering
</context>

<tasks>

<task type="auto">
  <name>Task 1: Filter STATE.md from navigation tree</name>
  <files>src/lib/navigation.js</files>
  <action>
Update buildNavTree() to filter out STATE.md:

1. At the beginning of buildNavTree, before the for loop, add a filter:
   ```javascript
   // Filter out STATE.md from navigation (internal/agent documentation)
   const filteredEntries = entries.filter(entry => {
     const id = entry.id.toLowerCase();
     return id !== 'state';
   });
   ```

2. Change the for loop to iterate over filteredEntries instead of entries:
   ```javascript
   for (const entry of filteredEntries) {
   ```

This keeps STATE.md accessible via direct URL (/STATE) since it's still in the content collection, but removes it from the navigation tree.
  </action>
  <verify>Run dev server, verify STATE.md not in sidebar but /STATE URL still works</verify>
  <done>STATE.md hidden from navigation, accessible via direct URL</done>
</task>

<task type="auto">
  <name>Task 2: Add icons to root documentation files in Sidebar</name>
  <files>src/components/Sidebar.astro</files>
  <action>
Update Sidebar.astro to display icons for root docs (PROJECT, ROADMAP, REQUIREMENTS):

1. Add icon definitions in the frontmatter script section:
   ```typescript
   // Icons for root documentation files (inline SVG)
   const rootDocIcons: Record<string, string> = {
     'PROJECT': '<path d="M8 1l6 3v8l-6 3-6-3V4z" fill="none" stroke="currentColor" stroke-width="1.5"/>',
     'ROADMAP': '<path d="M3 4h10M3 8h10M3 12h6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M13 11l-2 2 2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>',
     'REQUIREMENTS': '<rect x="3" y="3" width="10" height="10" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M6 7l1.5 1.5L10 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>'
   };

   // Helper to get icon for a root doc
   function getRootDocIcon(name: string): string | null {
     const baseName = name.replace('.md', '').toUpperCase();
     return rootDocIcons[baseName] || null;
   }
   ```

2. Update the nav-item rendering for regularNodes (root files) to include icons.
   Find the section that renders `regularNodes` leaf items (non-folder items).
   Update the link rendering to include icon:

   ```astro
   <li class="nav-item">
     <a
       href={node.path}
       aria-current={isCurrent ? 'page' : undefined}
       class:list={['nav-link', { current: isCurrent, 'has-icon': getRootDocIcon(node.name) }]}
     >
       {getRootDocIcon(node.name) && (
         <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" class="nav-icon">
           <Fragment set:html={getRootDocIcon(node.name)} />
         </svg>
       )}
       <span>{node.name}</span>
     </a>
   </li>
   ```

3. Add CSS for the icon styling:
   ```css
   .nav-link {
     display: flex;
     align-items: center;
     gap: var(--spacing-sm);
   }

   .nav-icon {
     flex-shrink: 0;
     color: var(--text-muted);
   }

   .nav-link.current .nav-icon {
     color: var(--link-color);
   }

   .nav-link:hover .nav-icon {
     color: var(--text-primary);
   }
   ```

Note: The existing `.nav-item a` styles should remain - just add the new classes for icon support.
  </action>
  <verify>Run dev server, verify PROJECT.md, ROADMAP.md, REQUIREMENTS.md show icons in sidebar</verify>
  <done>Root docs display with distinctive icons in navigation</done>
</task>

</tasks>

<verification>
1. Run `node bin/living-library.js` to start dev server
2. Open sidebar - PROJECT.md, ROADMAP.md, REQUIREMENTS.md have icons
3. STATE.md is NOT visible in sidebar
4. Navigate directly to /STATE - page loads correctly
5. Icons are visible in both light and dark themes
</verification>

<success_criteria>
- Root docs (PROJECT, ROADMAP, REQUIREMENTS) have icons in sidebar
- STATE.md hidden from sidebar navigation
- STATE.md still accessible via direct /STATE URL
- Icons inherit appropriate colors in both themes
</success_criteria>

<output>
After completion, create `.planning/phases/04-static-build-gsd-features/04-02-SUMMARY.md`
</output>
