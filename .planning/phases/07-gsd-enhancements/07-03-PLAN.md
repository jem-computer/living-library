---
phase: 07-gsd-enhancements
plan: 03
type: execute
wave: 2
depends_on: ["07-01", "07-02"]
files_modified:
  - src/pages/todos.astro
  - src/pages/dependencies.astro
  - src/pages/roadmap.astro
autonomous: true

must_haves:
  truths:
    - "/todos page displays todos grouped by area with unchecked first"
    - "/dependencies page renders interactive Cytoscape graph with clickable nodes"
    - "/roadmap page shows Kanban board with phases in pending/active/complete columns"
  artifacts:
    - path: "src/pages/todos.astro"
      provides: "Todo aggregation page"
      min_lines: 80
    - path: "src/pages/dependencies.astro"
      provides: "Dependency graph visualization page"
      min_lines: 100
    - path: "src/pages/roadmap.astro"
      provides: "Kanban roadmap visualization page"
      min_lines: 120
  key_links:
    - from: "src/pages/todos.astro"
      to: "src/lib/todos.js"
      via: "import getTodos"
      pattern: "getTodos"
    - from: "src/pages/dependencies.astro"
      to: "src/lib/dependencies.js"
      via: "import buildDependencyGraph"
      pattern: "buildDependencyGraph"
    - from: "src/pages/roadmap.astro"
      to: "src/lib/milestones.js"
      via: "import getMilestones"
      pattern: "getMilestones"
---

<objective>
Create the three visualization pages: todos aggregation, dependency graph, and roadmap Kanban board.

Purpose: GSD-05, GSD-06, GSD-07 require dedicated pages for each visualization
Output: Three new .astro pages that consume data from lib modules and render visualizations
</objective>

<execution_context>
@/Users/jem/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-gsd-enhancements/07-RESEARCH.md
@.planning/phases/07-gsd-enhancements/07-CONTEXT.md
@.planning/phases/07-gsd-enhancements/07-01-SUMMARY.md
@.planning/phases/07-gsd-enhancements/07-02-SUMMARY.md
@src/pages/timeline.astro
@src/layouts/DocLayout.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create src/pages/todos.astro</name>
  <files>src/pages/todos.astro</files>
  <action>
Create the todo aggregation page. Follow timeline.astro patterns for layout and styling.

Structure:
1. **Frontmatter section**:
   - Import DocLayout, getTodos, buildNavTree, getCollection
   - Call getTodos() to get all todos
   - Group todos by area using reduce()
   - Sort areas alphabetically, with "general" last

2. **Page layout**:
   - Use DocLayout with title="Todos"
   - Header: "Project Todos" with description "Tasks and improvements to address"

3. **Todo display**:
   - Group by area with section headers (e.g., "Testing", "General")
   - Each todo card shows:
     - Checkbox icon (checked/unchecked visual)
     - Title text
     - Source badge (standalone file or plan name like "06-01-PLAN")
     - Created date if available
   - Unchecked todos appear first within each area
   - Checked todos have muted styling

4. **Empty state**:
   - Show message if no todos found
   - Hint to create todos in `.planning/todos/pending/`

5. **Styling (scoped)**:
   - Area section with border, background
   - Todo items as cards with left border indicating status
   - Green border/icon for checked, gray for unchecked
   - Responsive: stack cards on mobile

Example markup:
```astro
<section class="todo-area">
  <h2 class="area-title">Testing</h2>
  <ul class="todo-list">
    <li class="todo-item" data-checked={todo.checked}>
      <span class="todo-check">{todo.checked ? '✓' : '○'}</span>
      <div class="todo-content">
        <span class="todo-title">{todo.title}</span>
        <span class="todo-source">{formatSource(todo.source)}</span>
      </div>
    </li>
  </ul>
</section>
```

Helper function formatSource(source):
- 'standalone' -> 'Todo File'
- 'phases/06-prettier-rendering/06-01-PLAN.md' -> '06-01-PLAN'
  </action>
  <verify>
Start dev server and navigate to http://localhost:4321/todos
- Page loads without errors
- Todos are grouped by area
- Unchecked todos appear first
- Source badges show correctly
  </verify>
  <done>/todos page renders todos grouped by area with visual status indicators</done>
</task>

<task type="auto">
  <name>Task 2: Create src/pages/dependencies.astro</name>
  <files>src/pages/dependencies.astro</files>
  <action>
Create the dependency graph visualization page using Cytoscape.js.

Structure:
1. **Frontmatter section**:
   - Import DocLayout, buildDependencyGraph, buildNavTree, getCollection
   - Call buildDependencyGraph() to get { nodes, edges, milestones }
   - Pass graph data to client script via define:vars

2. **Page layout**:
   - Use DocLayout with title="Dependencies"
   - Header: "Phase Dependencies" with description "Which phases block which"
   - Optional: Milestone filter dropdown if multiple milestones exist

3. **Graph container**:
   - Full-width div with id="cy" and min-height: 500px
   - Loading indicator that hides when graph renders

4. **Client-side script** (after page content):
   - Import cytoscape and dagre layout
   - Register dagre extension
   - Initialize Cytoscape with:
     - Container: document.getElementById('cy')
     - Elements: nodes and edges from graphData
     - Layout: dagre with rankDir: 'LR' (left-to-right)
     - Styles for nodes (color by status) and edges

5. **Cytoscape styling**:
   - Node colors: green (#10b981) for complete, blue (#3b82f6) for active, gray (#6b7280) for pending
   - Node shape: roundrectangle, width by label length
   - Edge style: bezier curve with arrow
   - Labels: wrap text, max width 150px

6. **Click handler**:
   - On node tap, navigate to node.data('url')
   - Cursor: pointer on hover

7. **Legend**:
   - Small legend showing color meanings below graph

Example client script:
```javascript
<script define:vars={{ graphData }}>
  import('cytoscape').then(cytoscapeModule => {
    import('cytoscape-dagre').then(dagreModule => {
      const cytoscape = cytoscapeModule.default;
      const dagre = dagreModule.default;
      cytoscape.use(dagre);

      const cy = cytoscape({
        container: document.getElementById('cy'),
        elements: {
          nodes: graphData.nodes.map(n => ({ data: n })),
          edges: graphData.edges.map(e => ({ data: { ...e, id: `${e.source}-${e.target}` } }))
        },
        layout: { name: 'dagre', rankDir: 'LR', nodeSep: 50 },
        style: [...]
      });

      cy.on('tap', 'node', evt => {
        window.location.href = evt.target.data('url');
      });
    });
  });
</script>
```
  </action>
  <verify>
Start dev server and navigate to http://localhost:4321/dependencies
- Page loads without errors
- Graph renders with phase nodes
- Nodes are color-coded by status
- Clicking a node navigates to that phase
- Edges show dependency relationships
  </verify>
  <done>/dependencies page renders interactive Cytoscape graph with clickable nodes and status coloring</done>
</task>

<task type="auto">
  <name>Task 3: Create src/pages/roadmap.astro</name>
  <files>src/pages/roadmap.astro</files>
  <action>
Create the Kanban roadmap visualization page. This provides an alternative view to timeline.astro.

Structure:
1. **Frontmatter section**:
   - Import DocLayout, getMilestones, buildNavTree, getCollection
   - Call getMilestones() to get all milestones with phases
   - Group phases by status: pending, active (in-progress), complete

2. **Page layout**:
   - Use DocLayout with title="Roadmap"
   - Header: "Project Roadmap" with description "Phase status across milestones"

3. **Milestone tabs** (if multiple milestones):
   - Tab buttons for each milestone (v1.1, v1.0, etc.)
   - Client-side JS to show/hide milestone boards
   - Default: show active/current milestone

4. **Kanban board** (per milestone):
   - Three columns: Pending | In Progress | Complete
   - CSS Grid: `grid-template-columns: repeat(3, 1fr)`
   - Column headers with count badges

5. **Phase cards**:
   - Compact card per phase showing:
     - Phase number and name
     - Progress indicator (X/Y plans complete) as small bar
     - Completion date if complete
   - Cards link to phase page (e.g., `/phases/06-prettier-rendering/`)

6. **Responsive**:
   - On mobile: single column with status as section header
   - Media query at 768px

7. **Styling (scoped)**:
   - Column background: subtle color per status (gray for pending, blue for active, green for complete)
   - Card hover effect
   - Progress bar using inline SVG or CSS width

Example markup:
```astro
<div class="kanban-board" data-milestone={milestone.version}>
  <div class="kanban-column" data-status="pending">
    <h3 class="column-header">Pending <span class="count">{pendingPhases.length}</span></h3>
    {pendingPhases.map(phase => (
      <a href={getPhaseUrl(phase)} class="phase-card">
        <span class="phase-number">Phase {phase.number}</span>
        <span class="phase-name">{phase.name}</span>
      </a>
    ))}
  </div>
  <div class="kanban-column" data-status="active">...</div>
  <div class="kanban-column" data-status="complete">...</div>
</div>
```

Helper function getPhaseUrl(phase):
- Build URL like `/phases/07-gsd-enhancements/`
- Pad number, slugify name
  </action>
  <verify>
Start dev server and navigate to http://localhost:4321/roadmap
- Page loads without errors
- Three columns visible (Pending, In Progress, Complete)
- Phases appear in correct columns based on status
- Cards link to phase pages
- Responsive layout works on narrow viewport
  </verify>
  <done>/roadmap page renders Kanban board with phases grouped by status in columns</done>
</task>

</tasks>

<verification>
1. `npm run dev` starts without errors
2. All three pages accessible at /todos, /dependencies, /roadmap
3. Todos page shows items grouped by area
4. Dependencies page renders interactive graph
5. Roadmap page shows Kanban columns
6. All pages use consistent DocLayout and styling
</verification>

<success_criteria>
- /todos page works without JS (pure server-rendered)
- /dependencies page loads Cytoscape graph with nodes and edges
- /roadmap page shows Kanban board with milestone tabs
- All pages are responsive (work on mobile)
- Navigation to linked content works (phase pages, todo sources)
</success_criteria>

<output>
After completion, create `.planning/phases/07-gsd-enhancements/07-03-SUMMARY.md`
</output>
