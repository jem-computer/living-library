---
phase: 02-content-navigation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/layouts/DocLayout.astro
  - src/components/Sidebar.astro
  - src/components/TableOfContents.astro
  - src/styles/global.css
autonomous: true

must_haves:
  truths:
    - "Page has 3-column layout on desktop (sidebar, content, TOC)"
    - "Layout is responsive with mobile breakpoints"
    - "Sidebar can display navigation tree"
    - "TOC displays page headings"
  artifacts:
    - path: "src/layouts/DocLayout.astro"
      provides: "Main 3-column documentation layout"
      min_lines: 50
    - path: "src/components/Sidebar.astro"
      provides: "Left navigation sidebar component"
      min_lines: 30
    - path: "src/components/TableOfContents.astro"
      provides: "Right TOC sidebar from headings"
      min_lines: 25
    - path: "src/styles/global.css"
      provides: "Base styles and responsive breakpoints"
      min_lines: 100
  key_links:
    - from: "src/layouts/DocLayout.astro"
      to: "src/components/Sidebar.astro"
      via: "component import"
      pattern: "import.*Sidebar"
    - from: "src/layouts/DocLayout.astro"
      to: "src/components/TableOfContents.astro"
      via: "component import"
      pattern: "import.*TableOfContents"
---

<objective>
Create the GitBook-style 3-column layout with left navigation sidebar, centered content, and right TOC sidebar. Fully responsive from mobile to desktop.

Purpose: Visual foundation for documentation browsing
Output: Layout component, Sidebar component, TOC component, global styles
</objective>

<execution_context>
@/Users/jem/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-content-navigation/02-CONTEXT.md
@.planning/phases/02-content-navigation/02-RESEARCH.md

Key decisions from context:
- GitBook-style layout: left nav, content center, TOC right
- Content area: readable width (~800px max), centered
- Right sidebar: table of contents from H2/H3 headings
- Header: minimal - just site title
- Light theme only for v1

Research patterns to follow:
- Pattern 3: TOC Generation from Headings Array (buildHierarchy function)
- Pattern 4: Responsive Sidebar with Mobile Collapse
- Mobile-first CSS with breakpoints at 768px and 1024px
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create global styles with responsive grid</name>
  <files>src/styles/global.css</files>
  <action>
    Create src/styles/global.css with:

    1. CSS Reset/base:
       - Box-sizing border-box
       - Clean typography (system font stack)
       - Remove default margins

    2. CSS Custom Properties:
       - --sidebar-width: 260px
       - --toc-width: 200px
       - --content-max-width: 800px
       - --header-height: 60px
       - Color palette (light theme only for v1):
         - --bg-primary: #ffffff
         - --bg-secondary: #f7f7f7
         - --text-primary: #1a1a1a
         - --text-secondary: #666666
         - --border-color: #e5e5e5
         - --link-color: #0969da
         - --code-bg: #f6f8fa

    3. Mobile-first responsive breakpoints:
       - Default: single column, full width
       - @media (min-width: 768px): 2 columns (sidebar + content)
       - @media (min-width: 1024px): 3 columns (sidebar + content + toc)

    4. Utility classes:
       - .sr-only for screen reader only text
       - .mobile-only, .desktop-only for responsive visibility

    5. Markdown content styles:
       - Typography for h1-h6
       - Code blocks with syntax highlighting support
       - Tables, blockquotes, lists
       - Links with hover states
  </action>
  <verify>Check file exists and contains CSS custom properties and media queries.</verify>
  <done>Global CSS established with responsive grid system and theme variables.</done>
</task>

<task type="auto">
  <name>Task 2: Create layout and sidebar components</name>
  <files>src/layouts/DocLayout.astro, src/components/Sidebar.astro, src/components/TableOfContents.astro</files>
  <action>
    1. Create src/components/Sidebar.astro:
       - Props: { tree, currentPath }
       - Render navigation tree recursively
       - Folders have collapsible children (aria-expanded)
       - Current page highlighted (aria-current="page")
       - Vanilla JS script for folder toggle
       - Use data-* attributes for JS hooks

    2. Create src/components/TableOfContents.astro:
       - Props: { headings }
       - buildHierarchy() function to nest flat headings
       - Only show H2 and H3 (filter depth 2-3)
       - Render as nested ul/li with anchor links
       - "On this page" heading

    3. Create src/layouts/DocLayout.astro:
       - Props: { headings, currentPath, navTree, title }
       - Import global.css
       - Import Sidebar and TableOfContents components
       - Header with site title ("Living Library")
       - Mobile menu toggle button (hamburger)
       - 3-column grid layout
       - Slot for main content
       - Vanilla JS for mobile menu toggle
       - Meta viewport for mobile

    Reference research Pattern 4 and 5 for exact implementation.
  </action>
  <verify>
    Components exist and have correct props.
    Run dev server and check for Astro compilation errors.
  </verify>
  <done>
    All three components created with responsive layout.
    Mobile menu toggle wired with vanilla JS.
    TOC builds hierarchy from headings array.
  </done>
</task>

</tasks>

<verification>
1. All four files created in correct locations
2. DocLayout imports Sidebar and TableOfContents
3. CSS has mobile-first media queries
4. No Astro compilation errors
</verification>

<success_criteria>
- Layout renders 3-column grid on desktop
- Sidebars hidden on mobile with menu toggle visible
- TOC component builds nested hierarchy from headings
- Clean GitBook-style aesthetic with light theme
</success_criteria>

<output>
After completion, create `.planning/phases/02-content-navigation/02-02-SUMMARY.md`
</output>
